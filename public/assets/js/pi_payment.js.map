{"version":3,"sources":["pi_payment.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"pi_payment.js","sourcesContent":["Architekt.event.on('ready', function() {\n\tvar Client = Architekt.module.Client;\n\tvar Http = Architekt.module.Http;\n\tvar Printer = Architekt.module.Printer;\n\tvar Validator = Architekt.module.Validator;\n\tvar Notice = Architekt.module.Widget.Notice;\n\tvar Confirm = Architekt.module.Widget.Confirm;\n\n\n\tvar paymentComplete = false;\t//this variable check for complete payment animation if already completed.\n\tvar dom = {\n\t\tmoduleBackground: $('#payment_module_background'),\n\t\tmodule: $('#payment_module'),\n\t\tnavs: $('.payment-nav-item'),\n\t\ttabContainer: $('.payment-tab'),\n\t\ttabs: {\n\t\t\teasy: $('#tab_easy'),\n\t\t\tpi: $('#tab_pi'),\n\t\t\tsms: $('#tab_sms'),\n\t\t\tpayment: $('#tab_payment'),\n\t\t},\n\t\tucp: {\n\t\t\tshown: false,\n\t\t\tcontainer: $('#payment_module_ucp'),\n\t\t\temail: $('#ucp_email'),\n\t\t\tlogout: $('#ucp_logout'),\n\t\t\tshow: function() {\n\t\t\t\tdom.ucp.shown = true;\n\n\t\t\t\tdom.ucp.container.stop(true, true).css({\n\t\t\t\t\theight: 0,\n\t\t\t\t\tpadding: 0,\n\t\t\t\t}).animate({\n\t\t\t\t\theight: '32px',\n\t\t\t\t\tpadding: '8px',\n\t\t\t\t}, 300, 'swing');\n\n\t\t\t\t//resize whole module\n\t\t\t\tdom.module.css({\n\t\t\t\t\theight: '532px',\n\t\t\t\t\t'margin-top': '-266px',\n\t\t\t\t});\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\thide: function() {\n\t\t\t\tdom.ucp.shown = false;\n\n\t\t\t\tdom.ucp.container.stop(true, true).css({\n\t\t\t\t\theight: '32px',\n\t\t\t\t\tpadding: '8px',\n\t\t\t\t}).animate({\n\t\t\t\t\theight: 0,\n\t\t\t\t\tpadding: 0\n\t\t\t\t}, 300, 'swing');\n\n\t\t\t\t//resize whole module\n\t\t\t\tdom.module.css({\n\t\t\t\t\theight: '500px',\n\t\t\t\t\t'margin-top': '-250px',\n\t\t\t\t});\n\n\t\t\t\treturn this;\n\t\t\t},\n\t\t},\n\t};\n\tvar qrCode = new QRCode($('#qrcode').get(0), Architekt.productInfo.address);\n\tvar component = {\n\t\teasy: {\n\t\t\temail: $('#email'),\n\t\t\tpassword: $('#password'),\n\t\t\tsubmit: $('#submitLogin'),\n\t\t\treset: function() {\n\t\t\t\t$('#email').val('');\n\t\t\t\t$('#password').val('');\n\t\t\t},\n\t\t},\n\t\tsms: {\n\t\t\tform: $('#smsForm'),\n\t\t\tcode: $('#authcode'),\n\t\t\tcipher: $('#cipher_id'),\n\t\t\tsubmit: $('#submitSms'),\n\t\t\treset: function() {\n\t\t\t\t$('#authcode').val('');\n\t\t\t\t$('#cipher_id').val('');\n\t\t\t},\n\t\t},\n\t\tpay: {\n\t\t\tsubmit: $('#pay'),\n\t\t}\n\t};\n\tvar currentTab = null;\n\tvar previousTab = null;\t//remember the preivous tab on switch the tab\n\n\t//socket for check pi-address payment(pi sending)\n\tvar paymentSocket = io('http://devpay.pi-pay.net:8800');\n\n\n\t//common error handler for validations\n\tfunction _error(text, focus, reset) {\n\t\tnew Notice({\n\t\t\ttext:text,\n\t\t\tcallback: function() {\n\t\t\t\tif(focus) focus.focus();\n\t\t\t\tif(reset) reset.val('');\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction appInit() {\n\t\t//module settings here:\n\t\tPrinter.setLevel(0);\n\n\t\t\n\t\tattachEvents();\n\t\tcomponentActions();\n\n\n\t\t//if user already logged in, display the user info and move to payment tab\n\t\tif(typeof Architekt.userInfo.email !== 'undefined') {\n\t\t\tcurrentTab = dom.tabs.payment;\n\t\t\tdom.ucp.email.text(Architekt.userInfo.email);\n\t\t\tdom.ucp.show();\n\n\t\t\t$('#payment_balance > h1').text(Architekt.userInfo.name + '님의 잔고');\n\t\t\t$('#payment_balance > p').text(parseFloat(Architekt.userInfo.balance).toFixed(1) + ' Pi');\n\t\t}\n\t\telse {\n\t\t\tcurrentTab = dom.tabs.easy;\n\n\t\t\tsetTimeout(function() {\n\t\t\t\tcomponent.easy.email.focus();\n\t\t\t}, 100);\n\t\t}\n\n\t\tcurrentTab.fadeIn(200);\n\t}\n\n\t/*****************************************************************************************\n\t *\n\t *\n\t * \t\t\t\t\t\t\t\tAnimation functions\n\t *\n\t *\n\t *****************************************************************************************/\n\n\tvar animation = {\n\t\tsubmitLogin: {\n\t\t\tisPlaying: false,\n\t\t\tplay: function() {\n\t\t\t\tif(this.isPlaying) return;\n\t\t\t\tthis.isPlaying = true;\n\n\t\t\t\tcomponent.easy.submit.addClass('locked');\n\t\t\t\tcomponent.easy.email.attr('readonly', true);\n\t\t\t\tcomponent.easy.password.attr('readonly', true);\n\n\t\t\t\tcomponent.easy.submit.parent().addClass('loading');\n\t\t\t},\n\t\t\tstop: function() {\n\t\t\t\tif(!this.isPlaying) return;\n\t\t\t\tthis.isPlaying = false;\n\n\t\t\t\tcomponent.easy.submit.removeClass('locked');\n\t\t\t\tcomponent.easy.email.removeAttr('readonly', true);\n\t\t\t\tcomponent.easy.password.removeAttr('readonly', true);\n\n\t\t\t\tcomponent.easy.submit.parent().removeClass('loading');\n\t\t\t},\n\t\t},\n\t\tsubmitSms: {\n\t\t\tisPlaying: false,\n\t\t\tplay: function() {\n\t\t\t\tif(this.isPlaying) return;\n\t\t\t\tthis.isPlaying = true;\n\n\t\t\t\tcomponent.sms.submit.addClass('locked');\n\t\t\t\tcomponent.sms.code.attr('readonly', true);\n\n\t\t\t\tcomponent.sms.submit.parent().addClass('loading');\n\t\t\t},\n\t\t\tstop: function() {\n\t\t\t\tif(!this.isPlaying) return;\n\t\t\t\tthis.isPlaying = false;\n\n\t\t\t\tcomponent.sms.submit.removeClass('locked');\n\t\t\t\tcomponent.sms.code.removeAttr('readonly', true);\n\n\t\t\t\tcomponent.sms.submit.parent().removeClass('loading');\n\t\t\t},\n\t\t},\n\t\tpay: {\n\t\t\tisPlaying: false,\n\t\t\tplay: function() {\n\t\t\t\tif(this.isPlaying) return;\n\t\t\t\tthis.isPlaying = true;\n\n\t\t\t\tcomponent.pay.submit.addClass('locked');\n\n\t\t\t\tcomponent.pay.submit.parent().addClass('loading');\n\t\t\t},\n\t\t\tstop: function() {\n\t\t\t\tif(!this.isPlaying) return;\n\t\t\t\tthis.isPlaying = false;\n\n\t\t\t\tcomponent.pay.submit.removeClass('locked');\n\n\t\t\t\tcomponent.pay.submit.parent().removeClass('loading');\n\t\t\t},\n\t\t},\n\t};\n\n\n\n\t /*****************************************************************************************\n\t *\n\t *\n\t * \t\t\t\t\t\t\tApplication manipulate functions\n\t *\n\t *\n\t *****************************************************************************************/\n\n\tfunction attachEvents() {\n\t\tvar _isSubmit = false;\t//check for form submit, prevent event duplication\n\t\tvar _is_switching_mode = false; //variable for check navigation switching animation\n\t\t\n\t\t// \tnavigation click: switch tab and navigation\n\t\tdom.navs.click(function() {\n\n\t\t\t//check if clicked already activated nav, exit\n\t\t\tvar idx = $(this).index();\n\t\t\t\n\t\t\tvar targetTab = null;\n\n\t\t\tswitch(idx) {\n\t\t\t\tcase 0:\n\t\t\t\t\ttargetTab = previousTab;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\t\ttargetTab = dom.tabs.pi;\n\t\t\t\t\tpreviousTab = currentTab;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif(currentTab === targetTab) return;\n\t\t\telse if(currentTab !== dom.tabs.pi && targetTab === previousTab) return;\n\n\n\t\t\tif(_is_switching_mode) return;\n\t\t\t_is_switching_mode = true;\n\n\n\t\t\tdom.navs.removeClass('on');\n\t\t\t$(this).addClass('on');\n\n\t\t\tcurrentTab.fadeOut(300, function() {\n\t\t\t\tcurrentTab = targetTab;\n\t\t\t\tcurrentTab.fadeIn(300, function() {\n\t\t\t\t\t_is_switching_mode = false;\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\t//easy payment - login\n\t\tvar _isSubmit = false;\n\t\tdom.tabs.easy.submit(function() {\n\t\t\tif(_isSubmit) return;\n\n\t\t\tvar email = component.easy.email;\n\t\t\tvar password = component.easy.password;\n\n\t\t\tif(!email.val()) {\n\t\t\t\t_error('이메일을 입력해주세요.', email);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse if(!password.val()) {\n\t\t\t\t_error('비밀번호를 입력해주세요.', password);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t//validation\n\t\t\tif(!Validator.is(email.val(), 'email') ) {\n\t\t\t\t_error('이메일은 이메일 형식에 맞춰 입력해주세요.', email);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse if(Validator.length(password.val(), '<', 6)) {\n\t\t\t\t_error('비밀번호는 6자리 이상을 입력해주세요.', password);\n\t\t\t\treturn false;\n\t\t\t}\n\n\n\t\t\t_isSubmit = true;\n\t\t\tanimation.submitLogin.play();\n\n\t\t\tHttp.post({\n\t\t\t\turl: '/oauth/loginOnce',\n\t\t\t\tdata: {\n\t\t\t\t\temail: component.easy.email.val(),\n\t\t\t\t\tpassword: component.easy.password.val(),\n\t\t\t\t},\n\t\t\t\tsuccess: function(data) {\n\t\t\t\t\tvar cipher = data.id;\n\n\t\t\t\t\tcomponent.sms.reset();\n\t\t\t\t\tcomponent.sms.cipher.val(cipher);\n\n\t\t\t\t\tcomponent.easy.reset();\n\n\t\t\t\t\tdom.tabs.easy.fadeOut(300, function() {\n\t\t\t\t\t\tcurrentTab = dom.tabs.sms;\n\n\t\t\t\t\t\tdom.tabs.sms.fadeIn(300, function() {\n\t\t\t\t\t\t\tcomponent.sms.code.focus();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\terror: function(err) {\n\t\t\t\t\tvar errText = '서버에 오류가 발생하였습니다. 관리자에게 문의해주세요.';\n\t\t\t\t\tvar errorMessage = err.response.status;\n\t\t\t\t\t\n\t\t\t\t\tif(errorMessage === 'failed') {\n\t\t\t\t\t\terrText = '잘못된 이메일이나 비밀번호입니다.';\n\t\t\t\t\t}\n\t\t\t\t\telse if(errorMessage === 'invalid_email') {\n\t\t\t\t\t\terrText = '유효하지 않은 이메일 주소입니다.';\n\t\t\t\t\t}\n\t\t\t\t\telse if(errorMessage === 'invalid_password') {\n\t\t\t\t\t\terrText = '유효하지 않은 비밀번호입니다.';\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tnew Notice({\n\t\t\t\t\t\ttext: errText,\n\t\t\t\t\t\tcallback: function() {\n\t\t\t\t\t\t\temail.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tPrinter.inspect(err);\n\t\t\t\t},\n\t\t\t\tcomplete: function() {\n\t\t\t\t\t_isSubmit = false;\n\t\t\t\t\tanimation.submitLogin.stop();\n\t\t\t\t}\n\t\t\t});\t\t\t\n\n\t\t\t//don't forget to no submit!\n\t\t\treturn false;\n\t\t});\n\n\t\t//easy payment - sms\n\t\tcomponent.sms.form.submit(function() {\n\t\t\tif(_isSubmit) return false;\n\n\t\t\tvar code = component.sms.code;\n\t\t\tvar cipher = component.sms.cipher;\n\n\t\t\tif(!code.val()) {\n\t\t\t\t_error('인증 번호를 입력해주세요.', component.sms.code);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t//validation\n\t\t\tif(!Validator.check(code.val(), 'numeric')) {\n\t\t\t\t_error('인증 번호는 숫자로 입력해주세요.', code, code);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse if(Validator.length(code.val(), '<', 5)) {\n\t\t\t\t_error('인증 번호는 5자리 입니다.', code);\n\t\t\t\treturn false;\n\t\t\t}\n\n\n\t\t\t_isSubmit = true;\n\t\t\tanimation.submitSms.play();\n\n\t\t\tHttp.post({\n\t\t\t\turl: '/oauth/smsAuth',\n\t\t\t\tdata: {\n\t\t\t\t\t'authcode': code.val(),\n\t\t\t\t\t'cipher_id': cipher.val(),\n\t\t\t\t},\n\t\t\t\tsuccess: function(data) {\n\t\t\t\t\tvar balance = data.balance;\n\t\t\t\t\tvar username = data.username;\n\t\t\t\t\tvar email = data.email;\n\n\t\t\t\t\tcomponent.sms.reset();\n\n\t\t\t\t\t//update user info dom\n\t\t\t\t\tdom.ucp.email.text(email);\n\t\t\t\t\tdom.ucp.show();\n\n\t\t\t\t\t$('#payment_balance > h1').text(username + '님의 잔고');\n\t\t\t\t\t$('#payment_balance > p').text(parseFloat(balance).toFixed(1) + ' Pi');\n\n\t\t\t\t\tdom.tabs.sms.fadeOut(300, function() {\n\t\t\t\t\t\tcurrentTab = dom.tabs.payment;\n\n\t\t\t\t\t\tdom.tabs.payment.fadeIn(300);\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\terror: function(err) {\n\t\t\t\t\tvar errText = '서버에 오류가 발생하였습니다. 관리자에게 문의해주세요.';\n\t\t\t\t\tvar errorMessage = err.response.status;\n\n\t\t\t\t\tif(errorMessage === 'failed') {\n\t\t\t\t\t\terrText = '잘못된 인증코드입니다. 다시 입력해주세요.';\n\t\t\t\t\t\tcode.val('');\n\t\t\t\t\t}\n\n\t\t\t\t\tnew Notice({\n\t\t\t\t\t\ttext: errText,\n\t\t\t\t\t\tcallback: function() {\n\t\t\t\t\t\t\tcode.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tPrinter.inspect(err);\n\t\t\t\t},\n\t\t\t\tcomplete: function() {\n\t\t\t\t\t_isSubmit = false;\n\t\t\t\t\tanimation.submitSms.stop();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn false;\n\t\t});\n\n\t\t//easy payment - pay: remember that pay tab is not a form\n\t\tcomponent.pay.submit.click(function() {\n\t\t\tif(_isSubmit) return;\n\n\n\t\t\t_isSubmit = true;\n\t\t\tanimation.pay.play();\n\n\t\t\tHttp.post({\n\t\t\t\turl: '/invoice/payment',\n\t\t\t\tdata: {\n\t\t\t\t\ttoken: Architekt.productInfo.token,\n\t\t\t\t},\n\t\t\t\tsuccess: function(data) {\n\t\t\t\t\tpaymentComplete = true;\n\n\t\t\t\t\tdestroyNav();\n\t\t\t\t\tdetachEvents();\n\n\t\t\t\t\t$('#payment_info').animate({\n\t\t\t\t\t\theight: '0',\n\t\t\t\t\t\topacity: '0.0'\n\t\t\t\t\t}, 300, 'swing', function() {\n\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\tcomponent.pay.submit.addClass('done').text('결제완료').off('click');\n\n\t\t\t\t\t\t$('#payment_complete').delay(100).show().animate({\n\t\t\t\t\t\t\theight: '80px',\n\t\t\t\t\t\t\topacity: '1.0',\n\t\t\t\t\t\t\t'margin-top': '80px',\n\t\t\t\t\t\t}, 300, 'swing', function() {\n\t\t\t\t\t\t\t$('#receipt').fadeIn(300);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\terror: function(err) {\n\t\t\t\t\tvar errText = '서버에 오류가 발생하였습니다. 관리자에게 문의해주세요.';\n\t\t\t\t\tvar errorMessage = err.response.status;\n\t\t\t\t\t\n\t\t\t\t\tnew Notice({\n\t\t\t\t\t\ttext: errText,\n\t\t\t\t\t\tcallback: function() {\n\t\t\t\t\t\t\temail.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tPrinter.inspect(err);\n\t\t\t\t},\n\t\t\t\tcomplete: function() {\n\t\t\t\t\t_isSubmit = false;\n\t\t\t\t\tanimation.pay.stop();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t//ucp logout\n\t\tdom.ucp.logout.click(function() {\n\t\t\tHttp.get({\n\t\t\t\turl: '/oauth/logout'\n\t\t\t});\n\n\t\t\tdom.ucp.hide();\n\n\t\t\tcurrentTab.fadeOut(300, function() {\n\t\t\t\tcurrentTab = dom.tabs.easy;\n\n\t\t\t\tdom.tabs.easy.fadeIn(300);\n\t\t\t});\n\n\t\t\treturn false;\n\t\t});\n\t}\n\n\tfunction detachEvents() {\n\t\tdom.ucp.logout.off('click');\n\t}\n\n\tfunction destroyNav() {\n\t\tdom.navs.fadeOut(300, function() {\n\t\t\t$(this).remove();\n\t\t\tdom.navs = null;\n\t\t});\t\n\t}\n\n\t//definition of common actions for components\n\tfunction componentActions() {\n\t\t//give focus effect on input\n\t\t$('.pi-payment-text > input').focus(function() {\n\t\t\t$(this).parent().addClass('on');\n\t\t}).blur(function() {\n\t\t\t$(this).parent().removeClass('on');\n\t\t});\n\n\t\t//auto select input\n\t\t$('div.pi-payment-text').click(function() {\n\t\t\t$(this).find('input').focus();\n\t\t});\n\t}\n\n\t//execute on end of the pi address payment\n\tfunction onAddressPaymentEnd() {\n\t\tif(paymentComplete) return;\n\t\tpaymentComplete = true;\n\n\t\tfunction _after() {\n\t\t\tvar qrwrap = $('#qr_wrap');\n\t\t\tvar completeDom = $('#complete');\n\t\t\tvar priceDom = $('#tab_pi_price');\n\n\t\t\tdestroyNav();\n\t\t\tdetachEvents();\n\n\t\t\tqrwrap.animate({\n\t\t\t\theight: '0',\n\t\t\t\topacity: '0.0'\n\t\t\t}, 300, 'swing', function() {\n\t\t\t\tqrwrap.remove();\n\t\t\t\tqrwrap = null;\n\n\t\t\t\tpriceDom.addClass('done');\n\n\t\t\t\tcompleteDom.delay(100).show().animate({\n\t\t\t\t\theight: '150px',\n\t\t\t\t\tpadding: '80px 32px 32px 32px',\n\t\t\t\t\topacity: '1.0',\n\t\t\t\t}, 500);\n\t\t\t});\n\t\t}\n\n\t\tif(currentTab !== dom.tabs.pi) {\n\t\t\tcurrentTab.fadeOut(150, function() {\n\t\t\t\tdom.tabs.pi.fadeIn(150, _after);\n\t\t\t});\n\t\t}\n\t\telse\n\t\t\t_after();\n\t}\n\n\t/********************************************************************************\n\t *\n\t *\n\t *                             Pi address payment\n\t *\n\t *\n\t ********************************************************************************/\n\n\tvar errorCheck = false;\n\tpaymentSocket.on('invoice-channel.' + Architekt.productInfo.id + ':invoice.payment-start', onAddressPaymentEnd);\n\tpaymentSocket.on('connect_error', function(data) {\n\t\tPrinter.error('Error with payment socket.');\n\t\tPrinter.inspect(data);\n\n\t\tif(!errorCheck) {\n\t\t\terrorCheck = true;\n\n\t\t\tnew Confirm({\n\t\t\t\ttext: '오류가 발생하여 파이 주소 결제가 제대로 동작하지 않습니다. [확인] 버튼을 누르면 페이지를 새로 불러옵니다.',\n\t\t\t\tcallback: function() {\n\t\t\t\t\tlocation.reload();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t});\n\tpaymentSocket.on('error', function(data) {\n\t\tPrinter.error('Error with payment socket.');\n\t\tPrinter.inspect(data);\n\t});\n\n\n\t//initialize animations\n\tdom.module.fadeIn(300, appInit);\n});"],"sourceRoot":"/source/"}